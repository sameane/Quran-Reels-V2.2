# وثيقة متطلبات المنتج (RPD) - مشروع Quran Reels v2

## 1. وصف المشروع
**Quran Reels v2** هو تطبيق ويب متطور يهدف إلى تمكين المستخدمين من إنشاء مقاطع فيديو قصيرة (Reels) احترافية للقرآن الكريم بشكل آلي. يجمع التطبيق بين قوة الذكاء الاصطناعي وجماليات التصميم الحديث لتقديم تجربة روحانية فريدة، حيث يتم تحليل معاني الآيات لاختيار خلفيات بصرية ملائمة، ودمجها مع التلاوات الصوتية والنصوص القرآنية في قالب بصري جذاب جاهز للمشاركة على منصات التواصل الاجتماعي.

---

## 2. مكونات واجهة المستخدم (UI Components)

### أ. لوحة التحكم الجانبية (Sidebar Controls)
- **اختيار السورة**: قائمة منسدلة تحتوي على جميع سور القرآن الكريم مع أسمائها بالعربية والإنجليزية.
- **نطاق الآيات**: حقول إدخال لتحديد بداية ونهاية المقطع المطلوب إنتاجه، مع التحقق من صحة النطاق بناءً على عدد آيات السورة المختارة.
- **اختيار القارئ**: قائمة تضم نخبة من القراء المشهورين لتخصيص التلاوة الصوتية.
- **زر الإنشاء (Generate)**: زر تفاعلي يبدأ عملية المعالجة والتحليل، مع عرض حالة التقدم (Progress) والرسائل التوضيحية.

### ب. منطقة العرض والتشغيل (Player Area)
- **المعاين (Canvas Player)**: شاشة عرض بنسبة 9:16 (Portrait) تحاكي شاشات الجوال، تعرض الفيديو النهائي مع كافة العناصر البصرية.
- **أدوات التحكم في التشغيل**:
    - زر التشغيل/الإيقاف المؤقت (Play/Pause).
    - زر التسجيل والتصدير (Record & Export).
    - زر إعادة الضبط (Reset).
- **نظام التنبيهات (Toast Notifications)**: تظهر في أعلى الشاشة لإبلاغ المستخدم بنجاح العمليات أو وجود أخطاء بشكل انسيابي.

---

## 3. آلية عمل أجزاء المشروع

### أ. محرك جلب البيانات (Data Engine)
1. **النصوص**: يتم جلب النص العربي والترجمة الإنجليزية من خلال API خارجي موثوق.
2. **الصوت**: يتم إنشاء روابط ملفات MP3 بناءً على القارئ والسورة والآية المختارة.
3. **تنقية النصوص**: يتم فحص الآية الأولى من السورة وحذف "البسملة" آلياً (باستثناء سورة الفاتحة) لضمان تناسق العرض البصري.

### ب. تحليل المحتوى بالذكاء الاصطناعي (AI Analysis)
- يستخدم التطبيق نموذج **Gemini 2.5 Flash** لتحليل ترجمة الآيات.
- يقوم النموذج باستخراج "كلمة مفتاحية بصرية" (Visual Keyword) تعبر عن بيئة أو مزاج الآية (مثل: جبال، بحر، نجوم، ضوء) مع تجنب العناصر البشرية تماماً.

### ج. محرك الوسائط (Media Engine)
- **البحث عن الفيديو**: يتم استخدام الكلمات المفتاحية المستخرجة للبحث في مجموعة مختارة من الفيديوهات عالية الجودة عبر Pexels API.
- **تعدد الخلفيات**: في حال كانت الآيات طويلة، يقوم التطبيق بجلب عدة فيديوهات وتغييرها بالتتابع لتتناسب مع طول التلاوة.

### د. المعالجة البصرية (Canvas Rendering)
- **تقسيم النصوص الطويلة**: يتم تقسيم الآيات التي تتجاوز سطرين إلى أجزاء تظهر بالتتابع بدقة متناهية مع الصوت.
- **المؤثرات البصرية**:
    - **Parallax Pulse**: الفيديو يتحرك بنبضات خفيفة تتفاعل مع قوة الصوت.
    - **Particles**: جزيئات ضوئية عائمة تضفي عمقاً وجمالاً على المشهد.
    - **Audio Visualizer**: مخطط ترددي يظهر في أسفل الفيديو يتفاعل مع نبرات القارئ.
- **التنسيق**: استخدام خط "Amiri" للقرآن و"Inter" للترجمة مع ظلال ناعمة لضمان الوضوح فوق أي خلفية.

### هـ. التسجيل والتصدير (Recording & Export)
- يستخدم التطبيق تقنية `MediaRecorder` لالتقاط محتوى الـ Canvas ودمجه مع مسار الصوت في الوقت الفعلي.
- يتم إنتاج ملف فيديو بصيغة MP4 أو WebM بجودة عالية (8 Mbps) جاهز للتحميل المباشر.

---

## 4. التقنيات المستخدمة
- **Frontend**: React, TypeScript, Tailwind CSS.
- **AI**: Google Gemini API.
- **Media**: Pexels API, Quran API.
- **Animation**: Motion (Framer Motion).
- **Icons**: Lucide React.
